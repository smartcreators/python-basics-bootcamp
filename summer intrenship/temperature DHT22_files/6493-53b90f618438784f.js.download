(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6493],{4242:e=>{e.exports={modalContent:"share-modal_modalContent__a0qu0",shareLinkContainer:"share-modal_shareLinkContainer___kHxS"}},23193:e=>{e.exports={container:"workbench-mobile_container__gLF2d",tab:"workbench-mobile_tab__VY3Ub",editor:"workbench-mobile_editor__nCRvf",diagram:"workbench-mobile_diagram__4gJe2"}},34426:(e,t,n)=>{"use strict";function r(e){return{sidesetCount:e>>29&7,sideEn:!!(e&1<<30)}}function a(e){const t=255&e;switch(e>>>13){case 0:{const e={0:"",1:"!x",2:"x--",3:"!y",4:"y--",5:"x!=y",6:"pin",7:"!osre"}[t>>5],n=31&t;return"jmp ".concat(e?e+", ":"").concat(n)}case 1:{const e={0:"gpio",1:"pin",2:"irq",3:"reserved"}[t>>5&3],n="irq"===e?7&t:31&t,r="irq"===e&&16&t?" rel":"";return"wait ".concat(128&t?"1":"0"," ").concat(e," ").concat(n).concat(r)}case 2:{const e=31&t;return"in ".concat({0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"reserved",6:"isr",7:"osr"}[t>>5],", ").concat(e||32)}case 3:{const e=31&t;return"out ".concat({0:"pins",1:"x",2:"y",3:"null",4:"pindirs",5:"pc",6:"isr",7:"exec"}[t>>5],", ").concat(e||32)}case 4:{const e=32&t?"":" noblock",n=64&t;return 128&t?"pull".concat(n?" ifempty":"").concat(e):"push".concat(n?" iffull":"").concat(e)}case 5:{const e={0:"pins",1:"x",2:"y",3:"null",4:"reserved",5:"status",6:"isr",7:"osr"}[7&t],n=t>>3&3,r={0:"pins",1:"x",2:"y",3:"reserved",4:"exec",5:"pc",6:"isr",7:"osr"}[t>>5&7],a=0===n?"":1===n?"~":2===n?"::":"";return e===r&&0===n?"nop":"mov ".concat(r,", ").concat(a).concat(e)}case 6:{if(128&t)return".data ".concat(e.toString(16));const n=32&t?" wait":"",r=16&t?" rel":"",a=7&t;return"irq".concat(64&t?" clear":"").concat(n," ").concat(a).concat(r)}case 7:{const e=31&t;return"set ".concat({0:"pins",1:"x",2:"y",4:"pindirs"}[t>>5],", ").concat(e)}}return".data ".concat(e.toString(16))}function i(e){let{sidesetCount:t,sideEn:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(0);const i=[],s=[];for(let r=0;r<e.length;r++){const o=e[r],l=o>>8&31,c=l&(1<<5-t)-1;let d=a(o);if(t&&(!n||16&l)){let e=l>>5-t;n&&(e&=(1<<t-1)-1),d+=" .side(".concat(e,")")}c&&(d+=" [".concat(c,"]")),i[r]={address:r,text:d,label:!1},o>>13||s.push(31&o)}for(const e of s)i[e]&&(i[e].label=!0);return i}n.d(t,{W:()=>r,n:()=>i})},40903:(e,t,n)=>{"use strict";n.d(t,{U:()=>p});var r=n(95155),a=n(66292),i=n(62861),s=n(78679),o=n(12422),l=n(62966),c=n(73831),d=n(63438),u=n(12115),h=n(82054);const p=(0,d.PA)((e=>{let{project:t,isOpen:n,onClose:d}=e;const[p,m]=(0,u.useState)(t.name),x=()=>{d()},g=()=>{t.id&&p&&(t.setName(p),(0,h.T)(t.id,{name:p})),d()};return(0,r.jsx)(i.A,{open:n,onClose:x,children:(0,r.jsxs)("form",{onSubmit:e=>{g(),e.preventDefault()},children:[(0,r.jsx)(l.A,{children:"Rename Project"}),(0,r.jsx)(o.A,{children:(0,r.jsx)(c.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:p,fullWidth:!0,variant:"outlined",onChange:e=>{m(e.target.value)}})}),(0,r.jsxs)(s.A,{children:[(0,r.jsx)(a.A,{color:"inherit",onClick:x,children:"Cancel"}),(0,r.jsx)(a.A,{variant:"contained",disabled:0===p.length,onClick:g,children:"Rename"})]})]})})}))},41226:()=>{},48240:e=>{e.exports={debugger:"pio-debugger_debugger__2dWGi",current:"pio-debugger_current__Eqs2r",listing:"pio-debugger_listing__H8pXq",lineNumber:"pio-debugger_lineNumber__5b5Ch",breakpoint:"pio-debugger_breakpoint__IFSxP",registers:"pio-debugger_registers__AGbJB",fifo:"pio-debugger_fifo__Zla_w"}},52820:e=>{e.exports={debugBar:"debugger-toolbar_debugBar__unQYJ",button:"debugger-toolbar_button__5kN9D",disabled:"debugger-toolbar_disabled__sMvP0",stopButton:"debugger-toolbar_stopButton__E6szZ"}},59197:e=>{e.exports={splitPane:"workbench-desktop_splitPane__nOV1_",container:"workbench-desktop_container__LDB8z",editor:"workbench-desktop_editor__AmDGz",preview:"workbench-desktop_preview__AdZiG",diagramOnly:"workbench-desktop_diagramOnly__6EwWF"}},62188:(e,t,n)=>{"use strict";n.d(t,{z:()=>kn});var r=n(95155),a=n(5036),i=n(1773),s=n.n(i),o=n(57907),l=n(57919),c=n(30139),d=n(73432),u=n(1384),h=n(50095),p=n(21030),m=n(16150),x=n(34152),g=n(76898),b=n(43388),f=n(66292),v=n(78822),j=n(44146),A=n(25170),y=n(63438),k=n(78126),w=n.n(k),C=n(6874),P=n.n(C),_=n(35695),S=n(12115),I=n(60025),L=n(88176),E=n(87231),F=n(1611),D=n(89697),R=n(36207),N=n(50390),W=n(85644),T=n(52835),z=n(66587);const U=(0,S.createContext)(null),B=(0,A.A)(f.A)({minWidth:"28px",padding:"4px 0"});function O(e){let{text:t,children:n,variant:a,...i}=e;const[s,o]=(0,S.useState)(!1),l=(0,S.useRef)(null),c=()=>o(!1);return(0,r.jsxs)(U.Provider,{value:{closeMenu:c},children:[(0,r.jsxs)(T.A,{variant:a,ref:l,children:[(0,r.jsx)(f.A,{variant:a,...i,children:t}),(0,r.jsx)(B,{size:"small",onClick:()=>o(!0),variant:a,children:(0,r.jsx)(W.A,{})})]}),(0,r.jsx)(z.A,{open:s,onClose:c,anchorEl:l.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:n})]})}function M(e){let{children:t}=e;const n=(0,S.useContext)(U);return(0,r.jsx)("div",{onClick:()=>{null==n||n.closeMenu()},children:t})}var H=n(51292),G=n(21942);const K=e=>{let{children:t}=e;return(0,r.jsx)(p.A,{direction:"column",minHeight:"100vh",children:t})};var Y=n(9670),V=n(62861),X=n(78679),J=n(12422),q=n(62966),Z=n(73831),$=n(77498),Q=n(47298),ee=n(67384),te=n(83124),ne=n(60717),re=n(96979);const ae=(0,y.PA)((e=>{let{privacy:t,onPrivacyChange:n}=e;const a=(0,S.useContext)(E.Rs);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)($.A,{margin:"normal",children:[(0,r.jsx)(Q.A,{id:"privacy-radio-buttons-group",children:"Project privacy:"}),(0,r.jsxs)(ee.A,{"aria-labelledby":"privacy-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:e=>n(e.target.value),children:[(0,r.jsx)(g.A,{value:"public",control:(0,r.jsx)(te.A,{}),label:(0,r.jsxs)(p.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(m.A,{minWidth:60,children:"Public"}),(0,r.jsx)(ne.A,{fontSize:"small"})]})}),(0,r.jsx)(g.A,{value:"unlisted",control:(0,r.jsx)(te.A,{}),label:(0,r.jsxs)(p.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsx)(m.A,{minWidth:60,children:"Unlisted"}),(0,r.jsx)(re.A,{fontSize:"small"})]})})]})]}),"unlisted"===t&&!a.club&&(0,r.jsxs)(Y.A,{children:["In order to save unlisted projects, ",(0,r.jsx)("br",{}),"please join one of our paid plans.",(0,r.jsx)(f.A,{variant:"outlined",color:"secondary",href:"https://wokwi.com/pricing?ref=unlisted",target:"_blank",onClick:()=>(0,F.G)("club:learnMore:unlistedSave"),sx:{marginTop:1},children:"Learn more"})]})]})}));const ie=(0,y.PA)((e=>{let{project:t,isOpen:n,onClose:a,onSaveCopyClick:i}=e;const[s,o]=(0,S.useState)(""),l=(0,S.useContext)(E.Rs),[c,d]=(0,S.useState)("public");(0,S.useEffect)((()=>{n&&o(function(e){const t=e.match(/^(.*) \((\d+)\)$/);if(t){const e=t[1],n=parseInt(t[2],10);return"".concat(e," (").concat(n+1,")")}return e.endsWith(" Copy")?"".concat(e," (2)"):"".concat(e," Copy")}(t.name))}),[n,t.name]);const u=()=>{a()},h=()=>{s&&(t.setUnlisted("unlisted"===c),t.setLocked(!1),i(s),a())};var m;return(0,r.jsx)(V.A,{open:n,onClose:u,children:(0,r.jsxs)("form",{onSubmit:e=>{h(),e.preventDefault()},children:[(0,r.jsx)(q.A,{children:"Save a Copy"}),(0,r.jsx)(J.A,{children:(0,r.jsxs)(p.A,{children:[t.owner&&t.owner!==l.id&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(Y.A,{children:["This project is owned by ",null!==(m=t.ownerUsername)&&void 0!==m?m:"a different user","."]}),(0,r.jsx)(Y.A,{gutterBottom:!0,children:"You can save a copy of this project in your account."})]}),(0,r.jsx)(Z.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:s,fullWidth:!0,variant:"outlined",onChange:e=>{o(e.target.value)}}),(0,r.jsx)(ae,{privacy:c,onPrivacyChange:d}),(0,r.jsx)(Y.A,{variant:"caption",color:"text.secondary",children:"Don't share sensitive data (such as passwords) in public projects."})]})}),(0,r.jsxs)(X.A,{children:[(0,r.jsx)(f.A,{color:"inherit",onClick:u,children:"Cancel"}),(0,r.jsx)(f.A,{variant:"contained",disabled:0===s.length||"unlisted"===c&&!l.club,onClick:h,children:"Save Copy"})]})]})})}));var se=n(40903);const oe=(0,y.PA)((e=>{let{project:t,isOpen:n,onClose:a,onSaveClick:i}=e;const[s,o]=(0,S.useState)(t.name),[l,c]=(0,S.useState)("public"),d=()=>{a()},u=()=>{s&&(t.setUnlisted("unlisted"===l),i(s),a())},h=(0,S.useContext)(E.Rs);return(0,r.jsx)(V.A,{open:n,onClose:d,children:(0,r.jsxs)("form",{onSubmit:e=>{u(),e.preventDefault()},children:[(0,r.jsx)(q.A,{children:"Save Your Project"}),(0,r.jsx)(J.A,{children:(0,r.jsxs)(p.A,{children:[(0,r.jsx)(Z.A,{autoFocus:!0,margin:"dense",id:"name",label:"Project Name",value:s,fullWidth:!0,variant:"outlined",onChange:e=>{o(e.target.value)}}),(0,r.jsx)(ae,{privacy:l,onPrivacyChange:c}),(0,r.jsx)(Y.A,{variant:"caption",color:"text.secondary",children:"Don't share sensitive data (such as passwords) in public projects."})]})}),(0,r.jsxs)(X.A,{children:[(0,r.jsx)(f.A,{color:"inherit",onClick:d,children:"Cancel"}),(0,r.jsx)(f.A,{variant:"contained",disabled:0===s.length||"unlisted"===l&&!h.club,onClick:u,children:"Save"})]})]})})}));var le=n(94215),ce=n(4242),de=n.n(ce);function ue(e){let{link:t}=e;const{translate:n}=(0,I.W)("project.shareDialog"),i=(0,S.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",value:t,ref:i,readOnly:!0,onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.select()}}),(0,r.jsx)(v.A,{title:n("copyToClipboard","Copy to clipboard"),children:(0,r.jsx)(j.A,{onClick:e=>{var t;null===(t=i.current)||void 0===t||t.select(),document.execCommand("copy"),e.target.focus()},children:(0,r.jsx)(s(),{path:a.ADG,size:1})})})]})}function he(e){let{open:t,onClose:n,project:i,saving:o,onSaveProject:l}=e;const{translate:c}=(0,I.W)("project.shareDialog");var d;return(0,r.jsxs)(V.A,{open:t,onClose:n,classes:{paper:de().modalContent},children:[(0,r.jsx)(le.J,{onClose:n}),(0,r.jsx)(q.A,{children:c("title","Share Project")}),(0,r.jsx)(J.A,{children:(null==i?void 0:i.url)?(0,r.jsx)("div",{className:de().shareLinkContainer,children:(0,r.jsx)(ue,{link:null!==(d=i.url)&&void 0!==d?d:""})}):(0,r.jsxs)(Y.A,{children:[c("pleaseSave","To share this project, please save it first:"),(0,r.jsx)(m.A,{mt:2,children:(0,r.jsx)(f.A,{variant:"contained",startIcon:o?(0,r.jsx)(s(),{path:a.PJB,size:1,spin:!0}):(0,r.jsx)(s(),{path:a.nhs,size:1}),onClick:l,children:c("saveProject","Save project")})})]})}),(0,r.jsx)(X.A,{children:(0,r.jsx)(f.A,{onClick:n,children:c("closeButton","Close")})})]})}var pe=n(33667),me=n(77924);var xe=n(38300),ge=n(55592),be=n(99136),fe=n(80910),ve=n(93380),je=n(58071),Ae=n(46856);const ye=(0,y.PA)((e=>{let{show:t,onHide:n,featureName:a}=e;const i=encodeURIComponent("".concat(a));return(0,r.jsxs)(V.A,{open:t,onClose:n,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,r.jsx)(q.A,{id:"form-dialog-title",children:"Hmm... Upgrade?"}),(0,r.jsx)(J.A,{children:"File upload is only available for paying users."}),(0,r.jsxs)(X.A,{children:[(0,r.jsx)(f.A,{variant:"outlined",onClick:n,sx:{margin:1},children:"Close"}),(0,r.jsx)(f.A,{variant:"contained",href:"/pricing?ref=".concat(i),target:"_blank",children:"Learn more"})]})]})}));var ke=n(71023),we=n(17322),Ce=n(62516);function Pe(e){var t;return(0,r.jsxs)(m.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,r.jsx)(Ce.A,{variant:"determinate",...e}),(0,r.jsx)(m.A,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(Y.A,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(null!==(t=e.value)&&void 0!==t?t:100),"%")})})]})}const _e=(0,y.PA)((e=>{let{file:t,onRemove:n}=e;const a=t.name.substring(ve._j.length);return(0,r.jsxs)(fe.Ay,{secondaryAction:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(j.A,{onClick:()=>n(t),children:(0,r.jsx)(ke.A,{})})}),children:[(0,r.jsx)(x.A,{primary:a,secondary:"".concat(t.size," bytes"),sx:{marginRight:1}}),t.transferring&&(0,r.jsx)(Pe,{value:Math.floor(100*t.progress)}),t.uploadFailed&&(0,r.jsx)(v.A,{title:"Upload failed",children:(0,r.jsx)(we.A,{color:"error"})})]})})),Se=(0,y.PA)((()=>{const e=(0,pe.A)(),t=(0,Ae.B)(),{translate:n}=(0,I.W)("editor.sdCard"),[a,i]=(0,S.useState)(!1),s=async n=>{if(!e.club)return void i(!0);const{files:r}=await(0,je.Km)(n?{directory:!0}:{multiple:!0});for(const n of r)t.uploadFile(e,n,ve._j)},o=e=>t.removeServerFile(e),{sdCardFiles:l}=t;return(0,r.jsxs)(m.A,{display:"flex",flexDirection:"column",flex:1,height:0,children:[(0,r.jsx)(ye,{show:a,onHide:()=>i(!1),featureName:"sdcard"}),(0,r.jsxs)(m.A,{p:1,children:[(0,r.jsx)(O,{text:n("uploadFiles","Upload files"),variant:"contained",onClick:()=>s(!1),children:(0,r.jsx)(M,{children:(0,r.jsxs)(h.A,{onClick:()=>s(!0),children:[(0,r.jsx)(ge.A,{children:(0,r.jsx)(xe.A,{fontSize:"small"})}),(0,r.jsx)(x.A,{children:n("uploadCompleteFolder","Upload complete folder")})]})})}),(0,r.jsx)(f.A,{variant:"outlined",sx:{marginLeft:1},onClick:()=>{for(const e of Array.from(t.serverFiles))t.removeServerFile(e)},children:n("uploadCompleteFolder","Delete all files")})]}),(0,r.jsxs)(be.A,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},children:[!l.length&&(0,r.jsx)(fe.Ay,{children:(0,r.jsx)(x.A,{primary:n("noFilesYet","No files yet. Please upload some files.")})}),l.map((e=>(0,r.jsx)(_e,{file:e,onRemove:o},e.name)))]})]})}));var Ie=n(53784);var Le=n(40139),Ee=n(29543),Fe=n(72815),De=n(28912);function Re(e){switch(e){case Fe.i.Running:return"start";case Fe.i.Stopped:return"stop";case Fe.i.Paused:return"pause"}}var Ne=n(60904),We=n(21014),Te=n(90032),ze=n(36303),Ue=n(71863),Be=n(13600),Oe=n(74817),Me=n(18777),He=n(15843),Ge=n(55965),Ke=n(5056),Ye=n(85852),Ve=n(37483),Xe=n(55256),Je=n(84092),qe=n(6405),Ze=n(19240),$e=n(60078),Qe=n(70680),et=n(41476),tt=n(14144),nt=n(19169),rt=n(8342),at=n(67676);const it=e=>fetch(e).then((e=>e.json())),st=(0,y.PA)((e=>{let{onAddLibrary:t,onUploadLibrary:n}=e;const{data:a,error:i}=(0,nt.Ay)("https://libraries.wokwi.workers.dev/list",it),[s,o]=(0,S.useState)(""),[l,c]=(0,S.useState)(-1),d=(0,S.useRef)(null),u=(0,S.useRef)(null),p=(0,S.useRef)(null);if(i)return(0,r.jsx)(m.A,{p:1,children:(0,r.jsx)(Y.A,{children:"Error loading library index :-("})});const x=s.trim().toLowerCase();var g;const b=x&&null!==(g=null==a?void 0:a.libraries.filter((e=>e.toLowerCase().includes(x))))&&void 0!==g?g:[],v=e=>{const t=(e=>{const t=b.length-1;switch(e){case"ArrowUp":return Math.max(0,l-1);case"ArrowDown":return Math.min(t,l+1);case"PageUp":return Math.max(0,l-12);case"PageDown":return Math.max(0,l+12);default:return null}})(e.code);var n;null!=t&&(null===(n=u.current)||void 0===n||n.scrollIntoView({index:t,behavior:"auto",done:()=>c(t)}),e.preventDefault())};return(0,r.jsxs)(m.A,{p:2,minWidth:300,children:[(0,r.jsxs)(Ze.A,{position:"sticky",onFocus:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus()},children:[(0,r.jsx)($e.A,{autoFocus:!0,ref:d,value:s,onChange:e=>o(e.target.value),onClick:e=>e.stopPropagation(),sx:{width:"100%"},onKeyDown:e=>{if("Enter"===e.key){const n=l>=0&&b[l];n&&(t(n),e.preventDefault())}else"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&"PageUp"!==e.key&&"PageDown"!=e.key||(v(e),e.preventDefault())},endAdornment:(0,r.jsx)(Qe.A,{position:"end",children:(0,r.jsx)(Je.A,{})})})," "]}),(0,r.jsxs)(et.A,{children:[x&&!a&&(0,r.jsxs)(m.A,{py:2,children:[(0,r.jsx)(Y.A,{children:"Loading library index..."}),(0,r.jsx)(tt.A,{})]}),b.length>0&&(0,r.jsx)(rt.aY,{style:{height:"400px",maxHeight:"100%"},data:b,ref:u,scrollerRef:e=>{e instanceof HTMLElement&&(e.addEventListener("keydown",v),p.current=()=>e.removeEventListener("keydown",v))},itemContent:(e,n)=>(0,r.jsx)(h.A,{onClick:()=>t(n),className:(0,at.default)(e===l&&"Mui-focusVisible"),children:n},n)}),x&&!b.length&&(0,r.jsx)(Y.A,{color:"gray",children:"No libraries found"}),!x&&(0,r.jsx)(Y.A,{color:"gray",children:"Type some text to search for libraries"})]}),!x&&(0,r.jsx)(f.A,{startIcon:(0,r.jsx)(qe.A,{}),onClick:n,children:"Upload a library"})]})})),ot="wokwi:";var lt=n(70084),ct=n(25839),dt=n(82070),ut=n(55398);function ht(e){const t=e.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").replace(/\W+/g,"-").toLowerCase();return"https://www.arduinolibraries.info/libraries/".concat(t)}const pt=(0,y.PA)((e=>{let{library:t,onRemoveLibrary:n}=e;const[a,i]=t.split("@"),s=null==i?void 0:i.startsWith(ot),o=a+".zip",l=null==i?void 0:i.substring(6),c="https://wokwi.com/storage/libs/".concat(l,"/").concat(o);return(0,r.jsxs)(fe.Ay,{secondaryAction:(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)("a",{href:c,download:!0,children:(0,r.jsx)(j.A,{children:(0,r.jsx)(lt.A,{})})}),!s&&(0,r.jsx)(j.A,{href:ht(a),target:"_blank",children:(0,r.jsx)(ct.A,{})}),(0,r.jsx)(j.A,{onClick:n,children:(0,r.jsx)(ke.A,{})})]}),children:[(0,r.jsx)(ge.A,{children:(0,r.jsx)(ut.A,{children:(0,r.jsx)(dt.A,{})})}),(0,r.jsx)(x.A,{primary:s?o:a})]})}));var mt=n(54992);const xt=(0,y.PA)((e=>{let{uploadState:t}=e;const{translate:n}=(0,I.W)("project.libManager.uploadDialog"),a=()=>t.abort();return(0,r.jsxs)(V.A,{open:t.uploading,onClose:a,"aria-labelledby":"form-dialog-title",maxWidth:"md",children:[(0,r.jsx)(q.A,{id:"form-dialog-title",children:n("title","Uploading library...")}),(0,r.jsx)(J.A,{children:(0,r.jsx)(mt.d,{value:100*t.progress})}),(0,r.jsx)(X.A,{children:(0,r.jsx)(f.A,{onClick:a,children:n("cancelButton","Cancel")})})]})}));var gt=n(86447);class bt{async startUpload(e,t){this.uploading=!0,this.abortController=new AbortController;const n=await(0,R.Us)(e,t,{abortSignal:this.abortController.signal,onProgress:e=>this.updateProgress(e.loaded/e.total)}),r=this.abortController.signal.aborted;return this.finishUpload(),r?null:null!=n?n:null}updateProgress(e){this.progress=e}finishUpload(){this.uploading=!1,this.abortController=void 0}abort(){var e;this.uploading=!1,null===(e=this.abortController)||void 0===e||e.abort()}constructor(){(0,gt._)(this,"uploading",!1),(0,gt._)(this,"progress",0),(0,gt._)(this,"abortController",void 0),(0,Ee.l_)(this)}}const ft=(0,y.PA)((()=>{var e;const t=(0,Ae.B)(),n=(0,pe.A)(),a=(0,S.useRef)(null),[i,s]=(0,S.useState)(!1),[o,l]=(0,S.useState)(!1),[c]=(0,S.useState)(new bt);var d;const u=Array.from((0,Ve.h)(null!==(d=null===(e=t.findFile(Xe.mx))||void 0===e?void 0:e.content)&&void 0!==d?d:"")),h=e=>{t.libraryManager.addLibrary(e),s(!1)},p=e=>{t.libraryManager.removeLibrary(e)};return(0,r.jsxs)(m.A,{display:"flex",flexDirection:"column",flex:1,height:0,position:"relative",children:[(0,r.jsx)(xt,{uploadState:c}),(0,r.jsx)(ye,{show:o,onHide:()=>l(!1),featureName:"libman"}),(0,r.jsxs)(m.A,{p:1,children:[(0,r.jsx)(Y.A,{variant:"h5",component:"h2",children:"Project Libraries"}),(0,r.jsx)(v.A,{title:"Add a new library",children:(0,r.jsx)(Ge.A,{color:"primary",size:"medium",ref:a,onClick:()=>s(!0),sx:{position:"absolute",top:16,right:16,zIndex:10},children:(0,r.jsx)(He.A,{})})}),(0,r.jsx)(Ke.Ay,{open:i,anchorEl:a.current,onClose:()=>s(!1),onClick:()=>s(!1),onKeyDown:e=>{"Enter"===e.key&&(s(!1),e.stopPropagation())},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,r.jsx)(st,{onAddLibrary:h,onUploadLibrary:async()=>{if(!n.club)return void l(!0);const{files:e}=await(0,je.Km)({directory:!0}),t=Array.from(e).filter(R.$_);if(!t.length)return void alert("Invalid library: no source files (.c, .cpp, .h) found!");const r=await c.startUpload(n,t);r&&(p(r.libraryName),h("".concat(r.libraryName,"@").concat(ot).concat(r.fileId)))}})})]}),(0,r.jsxs)(be.A,{sx:{flex:1,bgcolor:"background.paper",overflow:"auto"},"aria-labelledby":"nested-list-subheader",subheader:(0,r.jsx)(Ye.A,{component:"div",id:"nested-list-subheader",children:"Installed Libraries"}),children:[!u.length&&(0,r.jsx)(fe.Ay,{children:(0,r.jsx)(x.A,{children:"No libraries installed."})}),u.map((e=>(0,r.jsx)(pt,{library:e,onRemoveLibrary:()=>p(e.split("@")[0])},e)))]})]})}));var vt=n(49471),jt=n(57706),At=n(2618);var yt=n(34426),kt=n(89621),wt=n(81613),Ct=n(80179),Pt=n(48240),_t=n.n(Pt);function St(e){const t=[],{items:n}=e;for(let e=0;e<4;e++)e<n.length?t.push((0,kt.Fd)(n[e])):t.push("        ");return e.empty&&(t[0]="<EMPTY> "),t.join(" ")}const It=(0,y.PA)((()=>{const[e,t]=(0,S.useState)(0),[n,a]=(0,S.useState)(0),[,i]=(0,S.useState)(0),s=(0,S.useContext)(Ct.O),o=s.tempRunner,l=o.cpu,c=o.pioRunners[e],{instructions:d,machines:u}=l.pio[e],h=u[n],p=h.pc,m=(0,S.useMemo)((()=>(0,yt.n)(d,(0,yt.W)(h.pinCtrl))),[d,h]),x=function(){const[,e]=(0,S.useState)(0);return(0,S.useCallback)((()=>{e((e=>e+1))}),[])}();(0,S.useEffect)((()=>{const e=setInterval((()=>{i(h.cycles)}),100);return()=>clearInterval(e)}),[h]);const g=()=>{l.pio[e].step(),s.forceUpdate(),i(h.cycles)},b=(0,S.useMemo)((()=>{if(!h.enabled)return"STOP";if(!h.waiting)return"RUN";const e=h.waitPolarity?"1":"0";switch(h.waitType){case 1:return"WAIT ".concat(e," PIN ").concat(h.waitIndex);case 2:return"WAIT RXFIFO";case 3:case 5:return"WAIT TXFIFO";case 4:return"WAIT ".concat(e," IRQ ").concat(h.waitIndex);default:return""}}),[h.waitType,h.waitPolarity,h.waitIndex,h.waiting,h.enabled]);return(0,r.jsxs)("div",{className:_t().debugger,onKeyPress:e=>{"n"===e.key.toLowerCase()&&(g(),e.preventDefault())},children:[(0,r.jsxs)("div",{children:["Wokwi PIO Debugger"," ",(0,r.jsxs)(T.A,{size:"small",children:[(0,r.jsx)(f.A,{onClick:()=>{s.paused?s.resume():s.pause()},children:s.paused?(0,r.jsx)(vt.A,{}):(0,r.jsx)(jt.A,{})}),(0,r.jsx)(f.A,{disabled:!s.running||!s.paused,children:(0,r.jsx)(At.A,{onClick:g})})]})," ","PIO:"," ",(0,r.jsxs)(T.A,{size:"small",children:[(0,r.jsx)(f.A,{onClick:()=>t(0),variant:0===e?"contained":"outlined",children:"0"}),(0,r.jsx)(f.A,{onClick:()=>t(1),variant:1===e?"contained":"outlined",children:"1"})]}),"Machine:",(0,r.jsxs)(T.A,{size:"small",children:[(0,r.jsx)(f.A,{onClick:()=>a(0),variant:0===n?"contained":"outlined",children:"0"}),(0,r.jsx)(f.A,{onClick:()=>a(1),variant:1===n?"contained":"outlined",children:"1"}),(0,r.jsx)(f.A,{onClick:()=>a(2),variant:2===n?"contained":"outlined",children:"2"}),(0,r.jsx)(f.A,{onClick:()=>a(3),variant:3===n?"contained":"outlined",children:"3"})]})]}),(0,r.jsx)("div",{className:_t().listing,children:m.map((e=>(0,r.jsxs)("pre",{className:(0,at.default)(e.address===p&&_t().current),children:[(0,r.jsx)("input",{title:"Breakpoint","aria-label":"Breakpoint",type:"checkbox",checked:!!(c.breakpoints&1<<e.address),className:(0,at.default)(_t().breakpoint),onChange:()=>{c.breakpoints^=1<<e.address,x()}}),(0,r.jsx)("span",{className:_t().lineNumber,children:(0,wt.dP)(e.address,2," ")}),(0,r.jsx)("span",{children:e.text})]},e.address)))}),(0,r.jsxs)("div",{className:_t().registers,children:["Registers: X ",(0,kt.Fd)(h.x)," Y ",(0,kt.Fd)(h.y)," ISR ",(0,kt.Fd)(h.inputShiftReg)," [",(0,r.jsx)("span",{children:(0,wt.dP)(h.inputShiftCount,2," ")}),"] OSR"," ",(0,kt.Fd)(h.outputShiftReg)," [",(0,r.jsx)("span",{children:(0,wt.dP)(h.outputShiftCount,2," ")}),"] CYCLES ",(0,r.jsx)("span",{children:(0,wt.dP)(h.cycles,8," ")})," ",b,(0,r.jsx)("br",{}),"RX: ",(0,r.jsx)("span",{className:_t().fifo,children:St(h.rxFIFO)}),"TX: ",(0,r.jsx)("span",{className:_t().fifo,children:St(h.txFIFO)})]})]})}));var Lt=n(42649),Et=n(91476);class Ft{get currentItemIndex(){return this._currentItemIndex}get running(){return this._running}get failed(){return this._failed}get success(){return!this._failed&&!this._running}async sleep(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];await new Promise((n=>{this.sleepDoneCallback=n,this.sleepEvent.schedule(e),t&&this.sim.resume()}))}async serialReadLine(e){if(0===this.serialBuffer.length){const t=new Promise((e=>{this.serialReadDone=e,this.sim.resume()}));await(e?Promise.race([t,e]):t),this.serialReadDone=()=>{}}return this.serialBuffer.shift()}fail(e){this._failed=!0,this._running=!1;const t=this.items[this._currentItemIndex];t.status="error",t.error=e}async step(){const e=this.items[this._currentItemIndex];if(e){switch(e.status="running",e.type){case"wait-serial":const t=e.timeout?this.sleep(1e6*e.timeout,!1):void 0;let n=await this.serialReadLine(t);for(;(null==n?void 0:n.trim())!==e.text;){if(!n){this.fail("Timed out after ".concat(e.timeout," ms"));break}n=await this.serialReadLine(t)}break;case"press-button":const r=this.diagram.parts.find((t=>t.id===e.partId));if(!r)return void this.fail("Part ".concat(e.partId," not found"));r.setFloatVar("pressed",1),await this.sleep(1e6*e.duration),r.setFloatVar("pressed",0);break;case"set-control":const a=this.diagram.parts.find((t=>t.id===e.partId));if(!a)return void this.fail("Part ".concat(e.partId," not found"));a.setFloatVar(e.control,e.value);break;case"delay":await this.sleep(1e6*e.duration)}this.running&&(e.status="success",this._currentItemIndex++,this.step())}else this._running=!1}constructor(e,t,n){(0,gt._)(this,"sim",void 0),(0,gt._)(this,"diagram",void 0),(0,gt._)(this,"items",void 0),(0,gt._)(this,"_currentItemIndex",void 0),(0,gt._)(this,"_running",void 0),(0,gt._)(this,"_failed",void 0),(0,gt._)(this,"sleepEvent",void 0),(0,gt._)(this,"sleepDoneCallback",void 0),(0,gt._)(this,"serialLine",void 0),(0,gt._)(this,"serialBuffer",void 0),(0,gt._)(this,"serialReadDone",void 0),this.sim=e,this.diagram=t,this.items=n,this._currentItemIndex=0,this._running=!0,this._failed=!1,this.sleepDoneCallback=()=>{},this.serialLine="",this.serialBuffer=[],this.serialReadDone=()=>{},(0,Ee.l_)(this);for(const e of n)e.status=void 0,e.error=void 0;this.sleepEvent=this.sim.tempRunner.createEvent((()=>{this.sim.pause(),this.sleepDoneCallback()})),this.sim.serialRx.subscribe((e=>{for(const t of e)10===t?(this.serialBuffer.push(this.serialLine),this.serialLine="",this.serialReadDone()):this.serialLine+=String.fromCharCode(t)})),this.step()}}var Dt=n(82415),Rt=n(9858),Nt=n(25029),Wt=n(1964);const Tt=(0,y.PA)((e=>{let{items:t,diagram:n}=e;const[a,i]=(0,S.useState)(!1),s=(0,S.useRef)(null);function o(e){t.push(e),i(!1)}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Dt.A,{ref:s,fontSize:"large",onClick:()=>i(!0),sx:{marginX:1,"&:hover":{color:"white"},cursor:"pointer"}}),(0,r.jsxs)(z.A,{anchorEl:s.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},open:a,onClose:()=>i(!1),children:[(0,r.jsxs)(h.A,{onClick:()=>{const e=n.parts.find((e=>"wokwi-pushbutton"===e.type));var t;o({type:"press-button",partId:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"btn1",duration:100})},children:[(0,r.jsx)(ge.A,{children:(0,r.jsx)(Rt.A,{})}),(0,r.jsx)(x.A,{children:"Interaction"})]}),(0,r.jsxs)(h.A,{onClick:()=>o({type:"delay",duration:1e3}),children:[(0,r.jsx)(ge.A,{children:(0,r.jsx)(Nt.A,{})}),(0,r.jsx)(x.A,{children:"Delay"})]}),(0,r.jsxs)(h.A,{onClick:()=>{o({type:"wait-serial",text:"Serial output",timeout:1e3})},children:[(0,r.jsx)(ge.A,{children:(0,r.jsx)(Wt.A,{})}),(0,r.jsx)(x.A,{children:"Serial"})]})]})]})})),zt=(0,y.PA)((e=>{let{index:t,item:n,onDelete:a}=e;const i="success"===n.status?"green":"error"===n.status?"#800":"#333";return(0,r.jsxs)(p.A,{sx:{width:250,border:"solid white 1px","&:hover .buttons":{opacity:1}},mb:2,position:"relative",children:[(0,r.jsxs)(p.A,{sx:{background:i},p:1,direction:"row",children:[(0,r.jsxs)(Y.A,{flex:"1",children:[t,". ",n.type]}),(0,r.jsxs)(p.A,{className:"buttons",direction:"row",sx:{opacity:0,transition:"opacity 0.2s","&:hover":{opacity:1}},children:[(0,r.jsx)(j.A,{size:"small",onClick:()=>{if("delay"===n.type){const e=prompt("Enter delay in milliseconds",n.duration.toString());e&&(n.duration=parseInt(e,10))}if("wait-serial"===n.type){const e=prompt("Enter expected serial text",n.text);e&&(n.text=e)}},children:(0,r.jsx)(u.A,{})}),(0,r.jsx)(j.A,{size:"small",onClick:()=>a(t),children:(0,r.jsx)(ke.A,{})})]}),"running"===n.status&&(0,r.jsx)(Ce.A,{size:24})]}),(0,r.jsxs)(p.A,{flex:1,sx:{minHeight:100},p:1,justifyContent:"center",children:[(0,r.jsx)(Y.A,{children:n.text?'"'.concat(n.text,'"'):"delay"===n.type?"".concat(n.duration," ms"):""}),n.error&&(0,r.jsx)(Y.A,{color:"error",children:n.error})]})]})})),Ut=Ee.sH.array([{type:"wait-serial",text:"Pushbutton Counter",timeout:1e3},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"press-button",partId:"btn1",duration:100},{type:"delay",duration:500},{type:"wait-serial",text:"Button pressed 3 times",timeout:500}]),Bt=(0,y.PA)((e=>{let{}=e;const t=(0,S.useContext)(Ct.O),[n,a]=(0,S.useState)(null),i=(0,Ae.B)(),s=(0,pe.A)();return(0,r.jsxs)(p.A,{maxHeight:"100%",children:[(0,r.jsx)(p.A,{direction:"row",p:1,px:2,children:(0,r.jsx)(f.A,{variant:"contained",onClick:async()=>{await t.start({files:i.files,chips:i.chips,binaryFiles:i.binaryFiles,diagram:i.diagram,sdCardFiles:i.sdCardFiles,projectId:i.id,tempProjectId:i.tempId,userId:s.id,orgId:s.orgId,autoPause:!0}),t.paused&&a(new Ft(t,i.diagram,Ut))},disabled:null==n?void 0:n.running,children:"Run"})}),(0,r.jsxs)(p.A,{direction:"row",padding:2,flexWrap:"wrap",flex:"1",overflow:"auto",alignItems:"center",children:[Ut.map(((e,t)=>(0,r.jsxs)(p.A,{direction:"row",alignItems:"center",children:[(0,r.jsx)(zt,{index:t+1,item:e,onDelete:e=>{Ut.splice(e-1,1)}},t),t<Ut.length-1&&(0,r.jsx)(Lt.A,{fontSize:"medium",sx:{marginX:1}})]},t))),!(null==n?void 0:n.running)&&(0,r.jsx)(Tt,{diagram:i.diagram,items:Ut}),(null==n?void 0:n.success)&&(0,r.jsx)(Et.default,{sx:{color:"#0f0",fontSize:128,marginLeft:6},onClick:()=>{for(const e of Ut)e.status=void 0,e.error=void 0;a(null)}})]})]})}));var Ot=n(73746),Mt=n(36963),Ht=n.n(Mt),Gt=n(58011),Kt=n(86817),Yt=n(52820),Vt=n.n(Yt);const Xt=(0,y.PA)((()=>{const e=(0,S.useContext)(Ct.O);return e.running&&e.debuggerEnabled?(0,r.jsxs)("div",{className:Vt().debugBar,children:[e.paused?(0,r.jsx)(v.A,{title:"Resume program",children:(0,r.jsx)("i",{className:(0,at.default)(Vt().button,"codicon codicon-debug-continue"),onClick:()=>e.resume()})}):(0,r.jsx)(v.A,{title:"Pause program",children:(0,r.jsx)("i",{className:(0,at.default)(Vt().button,"codicon codicon-debug-pause"),onClick:()=>e.pause()})}),(0,r.jsx)(v.A,{title:"Step over",children:(0,r.jsx)("i",{className:(0,at.default)(Vt().button,!e.paused&&Vt().disabled,"codicon codicon-debug-step-over"),onClick:()=>e.stepOver()})}),(0,r.jsx)(v.A,{title:"Step into",children:(0,r.jsx)("i",{className:(0,at.default)(Vt().button,!e.paused&&Vt().disabled,"codicon codicon-debug-step-into"),onClick:()=>e.stepInto()})}),(0,r.jsx)(v.A,{title:"Step out (run until return)",children:(0,r.jsx)("i",{className:(0,at.default)(Vt().button,!e.paused&&Vt().disabled,"codicon codicon-debug-step-out"),onClick:()=>e.stepOut()})})]}):null}));var Jt=n(59197),qt=n.n(Jt),Zt=n(46004),$t=n(84823),Qt=n(72117),en=n(59935);const tn=(0,Kt.X)().dark,nn=(0,y.PA)((e=>{let{diagram:t,readme:n,files:a}=e;var i;const[s,o]=(0,S.useState)(0),{translate:l}=(0,I.W)("simulator.tabs");var c;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(en.tU,{children:[(0,r.jsx)(en.oz,{onClick:()=>o(0),active:0===s,children:l("simulation","Simulation")}),(null==n||null===(i=n.content.trim())||void 0===i?void 0:i.length)?(0,r.jsx)(en.oz,{onClick:()=>o(1),active:1===s,children:l("description","Description")}):null]}),0===s&&t&&(0,r.jsx)(Qt.g,{diagram:t,files:a}),1===s&&(0,r.jsx)("section",{className:(0,at.default)("markdown-body",tn&&"dark"),children:(0,r.jsx)(Zt.oz,{remarkPlugins:[$t.A],children:null!==(c=null==n?void 0:n.content)&&void 0!==c?c:""})}),(0,r.jsx)("style",{children:"\n        .markdown-body {\n          background: #eee;\n          color: black;\n          overflow: auto; /* Enable scrolling */\n          padding: 1.5em;\n          min-height: 100%;\n        }\n        .markdown-body.dark {\n          background: #111;\n          color: inherit;\n        }\n        .markdown-body.dark a {\n          color: #88f;\n        }\n        .markdown-body.dark pre {\n          background: #333;\n        }\n\n        .markdown-body::-webkit-scrollbar {\n          height: 16px;\n          width: 16px;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb,\n        .markdown-body::-webkit-scrollbar-track {\n          border: 4px solid transparent;\n          border-radius: 8px;\n          background-clip: padding-box;\n        }\n\n        .markdown-body::-webkit-scrollbar-thumb {\n          min-height: 40px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-thumb {\n          background-color: #3d3a3a;\n        }\n\n        .markdown-body::-webkit-scrollbar-track {\n          margin-bottom: 8px;\n        }\n        .markdown-body.dark::-webkit-scrollbar-track {\n          background-color: #2a2a2a;\n        }\n\n        .markdown-body.dark table {\n          color: black;\n        }\n      "})]})})),rn=(0,y.PA)((e=>{let{project:t,files:n}=e;const a=(0,S.useContext)(H.p),{ref:i,width:s=1,height:o=1}=Ht()(),[l,c]=(0,S.useState)(""),d=(0,Ot.A)();(0,S.useEffect)((()=>{"diagram"===(0,Kt.X)().view&&c("diagram")}),[]),(0,S.useEffect)((()=>{var e;null===(e=a.doLayout)||void 0===e||e.call(a)}),[s,o,a]);const u=t.files.some((e=>["readme","diagram"].includes(e.type))),h=()=>(0,r.jsxs)("div",{className:qt().editor,ref:i,children:[(0,r.jsx)(Xt,{}),(0,r.jsx)(H.B,{tabs:n,architecture:t.architecture})]}),p=()=>(0,r.jsx)("div",{className:qt().preview,children:(0,r.jsx)(nn,{diagram:t.diagram,readme:t.readme,files:t.files})});return(0,r.jsx)("div",{className:qt().container,children:"diagram"===l?(0,r.jsx)("div",{className:qt().diagramOnly,children:p()}):u?(0,r.jsxs)(Gt.v,{split:"vertical",className:qt().splitPane,resizerOptions:{hoverCss:{background:d.palette.primary.light,marginLeft:-2,width:4}},collapse:{beforeToggleButton:(0,r.jsx)("button",{children:"âž¡"}),afterToggleButton:(0,r.jsx)("button",{children:"â¬…"}),overlayCss:{backgroundColor:"black"},collapseDirection:"right",buttonTransition:"zoom",buttonPositionOffset:-20,collapsedSize:10,collapseTransitionTimeout:350},children:[h(),p()]}):h()})}));var an=n(65055),sn=n(80460),on=n(35881),ln=n(23193),cn=n.n(ln);const dn=(0,on.Ay)(an.A)({minHeight:24,background:"#333"}),un=(0,on.Ay)(sn.A)((e=>{let{theme:t}=e;return{textTransform:"none",minHeight:24,paddingTop:t.spacing(1),paddingBottom:t.spacing(1),"&.Mui-selected":{background:t.palette.secondary.dark,color:t.palette.primary.contrastText}}}));function hn(e){const{children:t,value:n,index:a,...i}=e;return(0,r.jsx)("div",{className:cn().tab,role:"tabpanel",hidden:n!==a,id:"full-width-tabpanel-".concat(a),"aria-labelledby":"full-width-tab-".concat(a),...i,children:n===a&&t})}const pn=(0,y.PA)((e=>{let{project:t,files:n}=e;const{translate:a}=(0,I.W)("simulator.tabs"),i=(0,S.useContext)(H.p),{ref:s,width:o=1,height:l=1}=Ht()(),[c,d]=(0,S.useState)(0);(0,S.useEffect)((()=>{var e;null===(e=i.doLayout)||void 0===e||e.call(i)}),[o,l,i]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(dn,{value:c,onChange:(e,t)=>{d(t)},variant:"fullWidth",indicatorColor:"secondary",children:[(0,r.jsx)(un,{label:a("simulation","Simulation")}),(0,r.jsx)(un,{label:a("code","Code")})]}),(0,r.jsxs)("div",{className:cn().container,children:[(0,r.jsx)(hn,{value:c,index:0,children:(0,r.jsx)("div",{className:cn().diagram,children:t.diagram&&(0,r.jsx)(Qt.g,{diagram:t.diagram,files:t.files})})}),(0,r.jsx)(hn,{value:c,index:1,children:(0,r.jsx)("div",{className:cn().editor,ref:s,children:(0,r.jsx)(H.B,{tabs:n,architecture:t.architecture})})})]})]})})),mn={name:"Library Manager",content:"",customComponent:(0,r.jsx)(ft,{})},xn={name:"Test Scenario Editor",content:"",customComponent:(0,r.jsx)(Bt,{})},gn=(0,y.PA)((e=>{let{project:t,hex:a}=e;const i=(0,S.useContext)(Ct.O),s=(0,S.useContext)(H.p),o=(0,S.useContext)(Me.u),[l,c]=(0,S.useState)(s.ready),d=i.running&&i.showPioDebugger,u=(0,pe.A)(),h=(0,me.b)(),p=function(){const[e,t]=(0,S.useState)("large");return(0,S.useEffect)((()=>{const e=window.matchMedia("(max-width: 640px)"),n=window.matchMedia("(max-width: 1007px)"),r=()=>{e.matches?t("small"):n.matches?t("medium"):t("large")};return"addEventListener"in e?(e.addEventListener("change",r),n.addEventListener("change",r)):(e.addListener(r),n.addListener(r)),r(),()=>{"removeEventListener"in e?(e.removeEventListener("change",r),n.removeEventListener("change",r)):(e.removeListener(r),n.removeListener(r))}}),[]),e}(),m=function(e){var t;const n=(0,S.useMemo)((()=>({name:"SD Card",content:"",customComponent:(0,r.jsx)(Se,{})})),[]);return n.modified=e.sdCardFiles.some((e=>e.modified)),(null===(t=e.diagram)||void 0===t?void 0:t.parts.find((e=>"wokwi-microsd-card"===e.type)))?[n]:[]}(t);(0,S.useEffect)((()=>{(null==a?void 0:a.cacheKey)&&Ne.q.put(a.cacheKey,a)})),function(e){const t="Leave page? Changes you made may not be saved.";(0,S.useEffect)((()=>{const n=n=>{if(Ie.default.asPath!==n&&e()&&!confirm(t))throw Ie.default.events.emit("routeChangeError"),Ie.default.replace(Ie.default.asPath,Ie.default.asPath,{shallow:!0}),"Abort route change. Please ignore this error."},r=n=>{if(e())return n.preventDefault(),n.returnValue=t,t};return window.addEventListener("beforeunload",r),Ie.default.events.on("routeChangeStart",n),()=>{window.removeEventListener("beforeunload",r),Ie.default.events.off("routeChangeStart",n)}}),[e])}((0,S.useCallback)((()=>t.modified),[t]));const x="_scenarios.json",g=[...t.files.filter((e=>e.name!==x)),...m,..."arduino"===t.projectType?[mn]:[],...t.files.find((e=>e.name===x))?[xn]:[],...d?[{name:"PIO ðŸ›",content:"",customComponent:(0,r.jsx)(It,{})}]:[],...i.debuggerFiles],b={userId:u.id,orgId:u.orgId,projectId:t.id,tempProjectId:t.tempId,hp:u.club};(0,S.useEffect)((()=>{t&&l&&t.diagram&&i.start({userId:u.id,orgId:u.orgId,projectId:t.id,files:t.files,diagram:t.diagram,preload:!0})}),[t,l,i,u.id,u.orgId]),s.onEditorReady=()=>{c(!0)},s.onRunCode=()=>{t.diagram&&i.start({...b,files:t.files,diagram:t.diagram})};const f=e=>{t.diagram&&i.start({...b,files:t.files,diagram:t.diagram,autoPause:!0,elf:!0,debug:e})};return s.commands.startPaused={name:"Start program paused",callback:f},s.commands.startPaused={name:"Profile program",callback:()=>{t.diagram&&i.start({...b,files:t.files,diagram:t.diagram,elf:!0,profile:!0})}},s.commands.assemblyListing={name:"View Compiled Assembly Code Listing",keybindings:e=>{let{KeyMod:t,KeyCode:n}=e;return[t.CtrlCmd|n.Backquote]},callback:()=>async function(e,t,n){e.removeFile(R.wK);const{hex:r,hexError:a}=await t.build({...n,files:e.files,diagram:e.diagram||Le.yF.create(),listing:!0});if(a)return console.error(a),void alert("Error connecting to build server: "+a);if(!(null==r?void 0:r.listing))return console.log(null==r?void 0:r.stderr),void alert("Build failed!");const i=e.findFile(R.wK);i?(i.update(r.listing),i.setPristine()):e.addFile(R.wK,r.listing)}(t,i,b)},s.commands.openControlSocket={name:"Open Debug Web Socket",callback:()=>{const e=prompt("Web socket URL?","ws://localhost:2442");e&&function(e,t,n){const r=new WebSocket(e),a=[];let i=!1,s=!1;const o=e=>{r.send(JSON.stringify(e))};r.addEventListener("open",(()=>{o({cmd:"aloha",protocol:"wokwi",version:1}),a.push((0,Ee.lB)(t,"status",(e=>{o({cmd:"statusChange",status:Re(e.newValue)}),e.newValue===Fe.i.Paused&&i&&o({cmd:"gdbResponse",response:t.breakpoint?De.vY:De.WH})}),!1))})),r.addEventListener("error",(()=>{alert("Web socket connection failed!")})),r.addEventListener("close",(()=>{for(const e of a)e();console.log("[Websocket] disconnected")})),r.addEventListener("message",(e=>{const r=e.data;let l;try{l=JSON.parse(r)}catch(e){return void console.error("[Websocket] invalid message:",r)}switch(l.cmd){case"start":{const e=l.hex,{diagram:r}=n;if(!r)return void console.error("[Websocket] can't start simulation: missing diagram");e?t.loadHex(e,r).then((()=>{t.resume()})):t.start({files:n.files,diagram:r});break}case"pause":t.pause();break;case"resume":t.resume();break;case"stop":t.stop();break;case"gdb":{i=!0,t.debugging=!0;const e=t.gdbMessage(l.message);e&&o({cmd:"gdbResponse",response:e})}break;case"serialMonitor":var c,d;s||(a.push(null!==(d=null===(c=t.serialRx)||void 0===c?void 0:c.subscribe((e=>{for(const t of e)o({cmd:"serialData",value:t})})))&&void 0!==d?d:()=>0),s=!0)}}))}(e,i,t)}},s.commands.startGDB={name:"Start Web GDB Session (debug build)",callback:()=>{window.open("https://wokwi.github.io/web-gdb/"),f(!0),window.addEventListener("message",(e=>{const t=e.data;"gdbInit"===t.type&&(console.log("GDB Attached!"),function(e,t){const n=(0,Ee.lB)(e,"status",(n=>{n.newValue!==Fe.i.Paused||e.restarting||t.postMessage({type:"gdb",data:e.breakpoint?De.vY:De.WH})}),!1);e.debugging=!0,t.onmessage=n=>{const r=n.data;switch(r.type){case"break":e.pause();break;case"downloadElf":e.buildResult&&t.postMessage({type:"elf",data:e.buildResult.elf});break;case"downloadSources":var a;(null===(a=e.buildResult)||void 0===a?void 0:a.debugSources)&&t.postMessage({type:"sources",data:(0,Ee.HO)(e.buildResult.debugSources)});break;case"gdb":{const n=e.gdbMessage(r.data);n&&t.postMessage({type:"gdb",data:n})}}},t.onmessageerror=()=>{e.debugging=!1,n()}}(i,t.data))}))}},s.commands.downloadHex={name:"Download Compiled Firmware",callback:async()=>{const{hex:e,hexError:n}=await i.build({...b,files:t.files,diagram:t.diagram||Le.yF.create()});var r,a;if(n)alert(n);else if(null===(a=t.diagram)||void 0===a||null===(r=a.board)||void 0===r?void 0:r.mcuType.startsWith("esp32")){const n=t.diagram.board.mcuType;var s;(0,Oe.PE)("firmware-".concat(n,".bin"),(0,Ue.Gp)(null!==(s=null==e?void 0:e.hex)&&void 0!==s?s:""),"application/octet-stream")}else{if((null==e?void 0:e.hex)&&!(null==e?void 0:e.hex.startsWith(":"))){const t=(0,Ue.Gp)(e.hex);if((0,Te.c)(t))return void(0,Oe.PE)("firmware.uf2",t,"application/octet-stream")}var o;(0,Oe.PE)("firmware.hex",null!==(o=null==e?void 0:e.hex)&&void 0!==o?o:"","application/octet-stream")}}},s.commands.flash={name:"Flash firmware to device (beta)",callback:async()=>{var e,n;const r=null===(n=t.diagram)||void 0===n||null===(e=n.board)||void 0===e?void 0:e.mcuType;if(!(null==r?void 0:r.startsWith("esp32")))return void alert("This feature is only available for ESP32 boards");const{hex:a,hexError:s}=await i.build({...b,files:t.files,diagram:t.diagram||Le.yF.create()});if(s)alert(s);else if(a){const e="".concat(a.cacheKey,"-").concat((new Date).getTime());window.open("https://flasher-esp32.apps.wokwi.com/?mcu=".concat(r,"&build=").concat(e)),window.addEventListener("message",(t=>{const n=t.data,r=n.port;if("loadBinary"===n.type&&n.build===e){var i;const e=(0,Ue.Gp)(null!==(i=null==a?void 0:a.hex)&&void 0!==i?i:"");r.postMessage({type:"flash",binaries:[{offset:65536,data:e.buffer}]},{transfer:[e.buffer]})}}))}}},s.commands.downloadUF2={name:"Download UF2 Binary",callback:async()=>{const e=n.e(1292).then(n.bind(n,91292)),{hex:r,hexError:a}=await i.build({...b,files:t.files,diagram:t.diagram||Le.yF.create()}),{hexToUF2:s}=await e;var o;a?alert(a):(0,Oe.PE)("firmware.uf2",s(null!==(o=null==r?void 0:r.hex)&&void 0!==o?o:""),"application/octet-stream")}},s.commands.downloadELF={name:"Download ELF with Debugging Symbols",callback:async()=>{const{hex:e,hexError:n}=await i.build({...b,files:t.files,diagram:t.diagram||Le.yF.create(),elf:!0,debug:!0});var r;n?alert(n):(0,Oe.PE)("firmware.elf",(0,Ue.Gp)(null!==(r=null==e?void 0:e.elf)&&void 0!==r?r:""),"application/octet-stream")}},s.commands.simulateHex={name:"Load HEX File and Start Simulation...",callback:()=>{alert('This command has been renamed to "Upload Firmware and Start Simulationâ€¦"')}},s.commands.uploadFirmware={name:"Upload Firmware and Start Simulationâ€¦",callback:async()=>{const{files:e}=await(0,je.Km)({}),n=null==e?void 0:e[0];if(!n)return;const r=n.name.toLowerCase(),a=r.endsWith(".hex"),s=await(a?(0,je.Gu)(n):(0,je._N)(n));t.diagram&&i.start({...b,files:t.files,diagram:t.diagram,autoPause:r.includes("-pause."),profile:r.includes("-profile."),sideHex:s})}},s.commands.chipAPITracing={name:"Enable Chip API Tracing",callback:async()=>{(0,We.Y)()}},s.commands.loadCustomBoard={name:"Load custom board file...",callback:async()=>{const{files:e}=await(0,je.Km)({directory:!0}),n=[...e],r=n.find((e=>"board.json"===e.name)),a=n.find((e=>"board.svg"===e.name));if(!r)return void alert("Error: missing board.json!");if(!a)return void alert("Error: missing board.svg!");const[i,s]=await Promise.all([(0,je.Gu)(r),(0,je.Gu)(a)]);h.loadUserBoard(i,s),t.syncDiagram(),o.fit()}},s.commands.downloadPcap={name:"Download WiFi Packet Capture (PCAP) file",callback:async()=>{const{wifi:e}=i;e&&e.medium.frames.length?e.medium.downloadPcap():alert("No clients connect to the virtual WiFi")}},s.commands.enableGateway={name:"Enable Private Wokwi IoT Gateway",callback:()=>{if(!(0,ze.$D)(u))return void alert("This feature is only available for paying users: https://wokwi.com/pricing");const e=confirm("Enable local Wokwi IoT Gateway?");(0,ze.bJ)(e)}},s.commands.enablePrivateBuild={name:"Enable private build server",callback:()=>{const e=prompt("Build server name? (empty to disable)","");e&&"PIAI-df68d5f0"!==e&&"localhexi"!==e?alert("Unknown build server"):(localStorage.removeItem("__buildServer"),localStorage.removeItem("__hexi"),"localhexi"===e?localStorage.setItem("__hexi","http://localhost:4055"):e&&localStorage.setItem("__buildServer",e))}},(0,Be.lD)()&&(s.commands.loadLocalLibraries={name:"Select local Arduino libraries directory",callback:async()=>{const e=await(0,Be.G)();e&&(i.localLibraryDirectory=e)}}),s.commands.downloadPcap={name:"Force Save (for locked projects)",callback:async()=>{var e;null===(e=s.onSaveCode)||void 0===e||e.call(s,!0)}},"small"===p?(0,r.jsx)(pn,{project:t,files:g}):(0,r.jsx)(rn,{project:t,files:g})}));var bn=n(34477);const fn=(0,bn.createServerReference)("6068e216bfdc890d74625bf06eeedbceda78694f00",bn.callServer,void 0,bn.findSourceMapURL,"likeProjectAction");var vn=n(82054),jn=n(71262),An=n.n(jn);const yn=(0,A.A)(h.A)({height:48}),kn=(0,y.PA)((e=>{let{project:t,embedMode:n}=e;const[i,h]=(0,S.useState)(!1),[A,y]=(0,S.useState)(!1),[k,C]=(0,S.useState)(!1),[W,T]=(0,S.useState)(!1),[z,U]=(0,S.useState)(!1),B=(0,L.W)(),[Y]=(0,S.useState)({ready:!1,embedMode:n||B.embed,commands:{}}),V=(0,S.useContext)(Ct.O),X=(0,S.useContext)(E.Rs),{translate:J}=(0,I.W)("project"),q=(0,_.useRouter)();(0,S.useEffect)((()=>{(0,N.h)()}),[]),(0,S.useEffect)((()=>{X.token&&t.updateFromServer(X)}),[t,X,X.token]);const{hatcheryEgg:Z}=B;(0,S.useEffect)((()=>{Z&&t.loadEgg(Z)}),[t,Z]);const $=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t.locked){if(!e)return void alert(J("error.saveFailed","Save failed: project is locked!"));if(!confirm(J("confirm.saveLockedProject","Override locked project?")))return}if(t.name)if(te){h(!0);try{await(0,R.JU)(X,t,!1),t.setPristine()}catch(e){alert("Project saving failed! Your changes have not been saved.")}finally{h(!1)}}else U(!0);else T(!0)},Q=async e=>{h(!0);const n=t.name;try{t.setName(e);const n=await(0,R.JU)(X,t,!0);t.changeId(n.projectId),t.changeOwner(n.owner),t.setPristine(),q.push("/projects/".concat(t.id))}catch(e){alert("Project saving failed! Your changes HAVE NOT been saved.\n\n".concat(e)),t.setName(n)}finally{h(!1)}};Y.onSaveCode=$,(0,S.useEffect)((()=>()=>{V.closeProject()}),[t,V]);const ee=t.id?(0,D.a)("https://wokwi.com/share/".concat(t.id),t.updated):null,te=t.owner&&t.owner===X.id,{ownerUsername:ne}=t;return(0,r.jsxs)(K,{children:[(0,r.jsx)(w(),{children:ee&&(0,r.jsx)("link",{rel:"alternate",type:"application/json+oembed",href:ee,title:"Wokwi oEmbed provider"})}),(0,r.jsx)(G.P,{children:(0,r.jsxs)(p.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,r.jsxs)(O,{size:"small",onClick:()=>$(),disabled:!t.modified||i||t.locked,variant:"contained",text:(0,r.jsx)(m.A,{component:"span",sx:{display:{xs:"none",sm:"initial"}},children:J("header.save","Save")}),startIcon:i?(0,r.jsx)(s(),{path:a.PJB,size:1,spin:!0}):(0,r.jsx)(s(),{path:a.nhs,size:1}),children:[(0,r.jsxs)(M,{children:[(0,r.jsxs)(yn,{onClick:()=>y(!0),disabled:i,sx:{display:{xs:"block",sm:"none"}},children:[(0,r.jsx)("div",{className:An().buttonIcon,children:(0,r.jsx)(s(),{path:a.YuT,size:1})}),J("header.share","Share")]}),(0,r.jsxs)(yn,{disabled:null==t.id,onClick:()=>U(!0),children:[(0,r.jsx)("div",{className:An().buttonIcon,children:(0,r.jsx)(o.A,{})}),(0,r.jsx)(x.A,{children:J("menu.saveACopy","Save a copy")})]})]}),te&&(0,r.jsx)(yn,{children:(0,r.jsx)(g.A,{control:(0,r.jsx)(b.A,{name:"lock",checkedIcon:(0,r.jsx)(l.A,{}),icon:(0,r.jsx)(c.A,{}),checked:t.locked,onChange:(e,n)=>{null!=t.id&&((0,vn.T)(t.id,{locked:n}),t.setLocked(n))}}),label:J("menu.lockProject","Lock project")})}),(0,r.jsxs)(yn,{onClick:()=>(0,N.z)(t),children:[(0,r.jsx)("div",{className:An().buttonIcon,children:(0,r.jsx)(s(),{path:a.XCd,size:1})}),(0,r.jsx)(x.A,{children:J("menu.downloadProjectZip","Download project ZIP")})]})]}),(0,r.jsx)(f.A,{size:"small",className:An().button,sx:{display:{xs:"none",sm:"flex"}},onClick:()=>y(!0),disabled:i,variant:"contained",startIcon:(0,r.jsx)(s(),{path:a.YuT,size:1}),children:J("header.share","Share")}),t.isDBProject&&(0,r.jsx)(v.A,{title:t.userLiked?J("header.unlikeProjectTooltip","Unlike this project"):J("header.likeProjectTooltip","Like this project"),children:(0,r.jsx)(j.A,{onClick:async()=>{if(!X.loggedIn)return void alert(J("error.signInToLikeProject","Please sign-in to Like this project."));if(!t||!t.id)return;const e=!t.userLiked;t.updateUserLike(e),t.updateHearts((await fn(t.id,e)).hearts),(0,F.H)({action:e?"like":"unlike",category:"project",label:t.name})},color:t.userLiked?"primary":"default",size:"large",children:(0,r.jsx)(d.A,{})})}),(te||ne)&&(0,r.jsxs)(m.A,{mx:1,sx:{position:"relative",lineHeight:1.2,display:{xs:"none",md:"block"}},children:[t.name," ",(0,r.jsx)(j.A,{size:"small",sx:{position:"absolute",top:-4},onClick:()=>C(!0),children:(0,r.jsx)(u.A,{})}),ne&&(0,r.jsxs)("div",{children:["by"," ",(0,r.jsx)(P(),{href:"/makers/[maker]",as:"/makers/".concat(ne),children:ne})]})]})]})}),k&&(0,r.jsx)(se.U,{project:t,isOpen:k,onClose:()=>C(!1)}),(0,r.jsx)(oe,{project:t,isOpen:W,onClose:()=>T(!1),onSaveClick:Q}),(0,r.jsx)(ie,{project:t,isOpen:z,onClose:()=>U(!1),onSaveCopyClick:Q}),(0,r.jsx)(he,{open:A,project:t,onClose:()=>y(!1),saving:i,onSaveProject:()=>T(!0)}),(0,r.jsx)("main",{className:An().main,children:(0,r.jsx)(Ae.v.Provider,{value:t,children:(0,r.jsx)(H.p.Provider,{value:Y,children:(0,r.jsx)(gn,{project:t})})})})]})}))},71262:e=>{e.exports={main:"project-page_main__KMKhI",button:"project-page_button__5z1or",buttonIcon:"project-page_buttonIcon__tgieg"}},81613:(e,t,n)=>{"use strict";function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return function(e,t,n){for(;e.length<t;)e=n+e;return e}(e.toString(),t,n)}n.d(t,{dP:()=>r})},82054:(e,t,n)=>{"use strict";n.d(t,{T:()=>a});var r=n(34477);const a=(0,r.createServerReference)("60a1d3afda83445c7aae7c488aeb309dc603dc7312",r.callServer,void 0,r.findSourceMapURL,"updateProjectAction")},89697:(e,t,n)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return"https://wokwi.com/api/oembed?url=".concat(encodeURIComponent(e),"&t=").concat(t.getTime(),"}")}n.d(t,{a:()=>r})},90032:(e,t,n)=>{"use strict";n.d(t,{c:()=>i,i:()=>s});var r=n(92722);const a="wokwidbg;v1;";function i(e){return e.length>=512&&(0,r.Lf)(new Uint8Array(e.buffer.slice(0,512)))}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const s=n+e.length;let o=!1;for(let l=0;l<t.length;l+=512){const c=(0,r.Wq)(t.subarray(l,l+512)),{flashAddress:d,payload:u,flags:h}=c;if(d>=n&&d<s&&(e.set(u,d-n),o=!0),h&r.FV.notMainFlash){const e=String.fromCharCode.apply(null,Array.from(u));e.startsWith(a)&&i.push(e.substring(a.length))}}return o}}}]);